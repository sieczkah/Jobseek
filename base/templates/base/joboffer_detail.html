{% extends 'main.html' %}
{% block content %}

<div id="htmx-job-detail" class="d-block">
  <div class="d-flex flex-column">
    <div class="d-flex flex-row justify-content-between">
      <h4>{{ job_offer.posistion }} - {{ job_offer.company }}</h4>
    </div>
    <div class="row d-flex">
      <p class="mb-0 pb-0"><a href="{{ job_offer.link }}" target="_blank">Offer link</a> <span class="ms-3">Salary
          range: {{ job_offer.salary }}</span></p>
      <p class="small mt-0 pt-0 text-muted">Apply date: {{ job_offer.apply_date|date:"D d.m" }}, Last
        update:
        {{ job_offer.update_date|date:"D d.m" }}
        <span class="badge text-bg-info fw-bold">{{ job_offer.get_status_display }}</span>
      </p>
    </div>
  </div>
  <div class="accordion mb-3" id="accordionExample">
    <!-- COMPANY INFO  -->
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
          data-bs-target="#collapseCompany" aria-expanded="false" aria-controls="collapseCompany">
          About the company
        </button>
      </h2>
      <div id="collapseCompany" class="accordion-collapse collapse" data-bs-parent="#accordionExample" style="">
        <div class="accordion-body">
          {% if job_offer.company_personalized_info %}
          <p>{{ job_offer.company_personalized_info|linebreaksbr }}</p>
          {% else %}
          <p>{{ job_offer.company.general_info|linebreaksbr }}</p>
          {% endif %}
        </div>
      </div>
    </div>
    <!-- JOB DESCRIPTION -->
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
          data-bs-target="#collapseDescription" aria-expanded="false" aria-controls="collapseDescription">
          Job description
        </button>
      </h2>
      <div id="collapseDescription" class="accordion-collapse collapse" data-bs-parent="#accordionExample" style="">
        <div class="accordion-body">
          {{ job_offer.description|linebreaksbr }}
        </div>
      </div>
    </div>
    <!-- AI GENERATED -->
    {% if job_offer.ai_generated_data %}
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
          data-bs-target="#collapseAIData" aria-expanded="false" aria-controls="collapseAIData">
          Generated by AI Job Assistant
        </button>
      </h2>
      <div id="collapseAIData" class="accordion-collapse collapse" data-bs-parent="#accordionExample" style="">
        <div class="accordion-body">
          {{ job_offer.ai_generated_data|linebreaksbr }}
        </div>
      </div>
    </div>
    {% endif %}
  </div>

  <a href="{% url 'joboffer-update' job_offer.id %}" class="btn btn-primary">Edit offer</a>
  {% if user_is_pro %}
  <a href="{% url 'get-ai-offer' job_offer.id %}" class="btn btn-warning">Create AI data
  </a>
  {% else %}

  <a href="" class="btn btn-secondary disabled" disabled>Create AI data - Pro functionality
  </a>
  {% endif %}
</div>
{% endblock content %}